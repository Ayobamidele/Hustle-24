{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>H24| Product Edit</title>
	<link rel="stylesheet" href="{% static '/bootstrap/css/bootstrap-grid.css' %}">
	<link rel="stylesheet" href="{% static '/bootstrap/css/bootstrap-grid.min.css' %}">
	<link rel="stylesheet" href="{% static '/bootstrap/css/bootstrap-reboot.css' %}">
	<link rel="stylesheet" href="{% static '/bootstrap/css/bootstrap-reboot.min.css' %}">
	<link rel="stylesheet" href="{% static '/bootstrap/css/bootstrap.css' %}">
	<link rel="stylesheet" href="{% static '/bootstrap/css/bootstrap.min.css' %}">	
	<link rel="stylesheet" href="{% static '/icomoon/demo-files/demo.css' %}">
	<link rel="stylesheet" href="{% static '/css/vendor.css' %}">
	<link rel="stylesheet" href="{% static '/css/style.css' %}">
	<link rel="stylesheet" href="{% static '/icomoon/style.css' %}">
	<link rel="stylesheet" href="{% static '/icomoon/demo-files/demo.css' %}">
	<link rel="stylesheet" href="{% static '/css/h24.css' %}">
	
	<style>
		 #image-upload-demo {
        width: 100%;
        margin: auto;
    	}

		label {
		   cursor: pointer;
		   /* Style as you please, it will become the visible UI component. */
		}

		#upload-photo {
		   opacity: 0;
		   /*position: absolute;*/
		   z-index: -1;
		}
		.sdiv {
			padding-top: 20px !important;
		}
		#testimonials{
			display: flex;
			justify-content: center;
			align-items: center;
			flex-direction: column;
			width:100%;
		}
		.testimonial-heading{
			letter-spacing: 1px;
			margin: 30px 0px;
			padding: 10px 20px;
			display: flex;
			flex-direction: column;
			justify-content: center;
			align-items: center;
		}
		 
		.testimonial-heading span{
			font-size: 1.3rem;
			color: #252525;
			margin-bottom: 10px;
			letter-spacing: 2px;
			text-transform: uppercase;
		}
		.testimonial-box-container{
			display: flex;
			justify-content: center;
			align-items: center;
			flex-wrap: wrap;
			width:100%;
		}
		.testimonial-box{
			box-shadow: 2px 2px 30px rgba(0,0,0,0.1);
			background-color: #ffffff;
			padding: 20px;
			margin: 15px;
			cursor: pointer;
		}
		.profile-img{
			width:50px;
			height: 50px;
			border-radius: 50%;
			overflow: hidden;
			margin-right: 10px;
		}
		.profile-img img{
			width: 100%;
			height: 100%;
			object-fit: cover;
			object-position: center;
		}
		.profile{
			display: flex;
			align-items: center;
		}
		.name-user{
			display: flex;
			flex-direction: column;
		}
		.name-user strong{
			color: #3d3d3d;
			font-size: 1.1rem;
			letter-spacing: 0.5px;
		}
		.name-user span{
			color: #979797;
			font-size: 0.8rem;
		}
		.reviews{
			color: #f9d71c;
		}
		.box-top{
			display: flex;
			justify-content: space-between;
			align-items: center;
			margin-bottom: 20px;
		}
		.client-comment p{
			font-size: 0.9rem;
			color: #4b4b4b;
		}
		 
		@media(max-width:1060px){
			.testimonial-box{
				width:45%;
				padding: 10px;
			}
		}
		@media(max-width:790px){
			.testimonial-box{
				width:100%;
			}
			.testimonial-heading h1{
				font-size: 1.4rem;
			}
		}
		@media(max-width:340px){
			.box-top{
				flex-wrap: wrap;
				margin-bottom: 10px;
			}
			.reviews{
				margin-top: 10px;
			}
		}
		::selection{
			color: #ffffff;
			background-color: #252525;
		}
		.tab button:hover, .tab button:focus {
			outline: 0;
			box-shadow: none;
			color: #000;
			background-color: transparent;
		}
		.fa {
			font-size: 25px;
		  }
		  
		  .checked {
			color: orange;
		  }
		  
		  /* Three column layout */
		  .side {
			float: left;
			width: 15%;
			margin-top:10px;
		  }
		  
		  .middle {
			margin-top:10px;
			float: left;
			width: 70%;
		  }
		  
		  /* Place text to the right */
		  .right {
			text-align: right;
		  }
		  
		  /* Clear floats after the columns */
		  .row:after {
			content: "";
			display: table;
			clear: both;
		  }
		  
		  /* The bar container */
		  .bar-container {
			width: 100%;
			background-color: #f1f1f1;
			text-align: center;
			color: white;
		  }
		  
		  /* Individual bars */
		  .bar-5 {width: 60%; height: 18px; background-color: #04AA6D;}
		  .bar-4 {width: 30%; height: 18px; background-color: #2196F3;}
		  .bar-3 {width: 10%; height: 18px; background-color: #00bcd4;}
		  .bar-2 {width: 4%; height: 18px; background-color: #ff9800;}
		  .bar-1 {width: 15%; height: 18px; background-color: #f44336;}
		  
		  /* Responsive layout - make the columns stack on top of each other instead of next to each other */
		  @media (max-width: 400px) {
			.side, .middle {
			  width: 100%;
			}
			.right {
			  display: none;
			}
		  }
		  .heading {
			font-size: 25px;
			margin-right: 25px;
		  }
		.prate{
		  margin: 0 auto; /* Center website */
		  max-width: 800px; /* Max width */
		  padding: 20px;
		}

		#img-preview {
		  display: none; 
		  width: 100%;   
		  border: 2px dashed #333;  
		  margin-bottom: 20px;
		}
		#img-preview img {  
		  width: 100%;
		  height: auto; 
		  display: block;   
		}

		[type="file"] {
		  height: 0;  
		  width: 0;
		  overflow: hidden;
		}
		[type="file"] + label {
		  font-family: sans-serif;
		  background: #f44336;
		  padding: 10px 30px;
		  border: 2px solid #f44336;
		  border-radius: 3px;
		  color: #fff;
		  cursor: pointer;
		  transition: all 0.2s;
		}
		[type="file"] + label:hover {
		  background-color: #fff;
		  color: #f44336;
		}
		[name="price"],[name="dicsount"]{
		  padding: 10px;
		  font: 20px Arial;
		  width: 100%;
		}

		.input-categories{
		}

		.input-categories ul{
		  display: flex;
		  flex-direction: row;
		  justify-content: flex-start;
		  list-style-type: none;
		  flex-wrap: wrap;
		  height: 100px;
		  overflow: scroll;
		}

		.input-categories li{
		  border: 1px solid black;
		  border-radius: 2px;
		  font: 14px "Roboto", sans-serif;
		  padding: 8px;
		  margin: 1px;
		  height: max-content;
		}
		.input-categories input{
		  flex: 1 1 auto;
		  align-self: flex-start;
		  border: 1px solid;
		  margin: 3px;
		}
		.iu-image-item-style {
		    position: relative;
		    display:inline-block;
		    vertical-align: top;
		}

		*, ::after, ::before {
		    box-sizing: border-box;
		}

		.iu-highlight {
		    border: 2px dashed #ff1a1a !important;
		}

		.iu-image-note {
		    font-size: 1rem;
		    color: black;
		    z-index: 9;
		    cursor: pointer;
		}

		.iu-image-placeholder {
		    margin-bottom: 0px;
		    display: block;
		    padding: 5px;
		    background-clip: content-box;
		    position: relative;
		}

		.iu-image {
		    object-fit: cover;
		    width: 100%;
		    height: 100%;
		}

		.iu-image-order-number {
		    position:absolute;
		    top: 5px;
		    left: 5px;
		    color: white;
		    font-size: 1rem;
		    background: rgba(0,0,0,.3);
		    padding:2px 8px;
		}

		.iu-close-button {
		    position:absolute;
		    top: 5px;
		    right: 5px;
		    color: white;
		    background: rgba(0,0,0,.3);
		    width: 30px;
		    height: 30px;
		    border-radius: 50%;
		    font-weight: bold;
		    font-size: 1.4rem;
		    cursor:pointer;
		    display: flex;
		    justify-content: center;
		    align-items: center;
		}

		.iu-close-icon {
		    position: absolute;
		    top: 50%;
		    left: 50%;
		    transform: translate(-50%, -50%);
		    font-family: "Times New Roman", Times, serif;
		}

		.iu-close-button:hover {
		    background: rgba(0,0,0,.5);
		}

		.iu-button {
		    display: none;
		}

		@keyframes  iu-backgroundColor {
		    0% {background-color: #c0b3a5;}
		    50% {background-color: #a18d78;}
		    100% {background-color: #c0b3a5;}
		}

		.iu-select-number {
		    width: 100%;
		}

		.iu-custom-select {
		    position: relative;
		    padding: 5px;
		    margin-top: -10px;
		    font-size: 1rem;
		}

		.iu-display-none {
		    display: none;
		}

		.iu-select-selected {
		    background-color: #1f1c1c;
		}

		.iu-select-selected:after {
		    position: absolute;
		    content: "";
		    top: 50%;
		    transform: translate(0, calc(-50% + 3px));
		    right: calc(10px + 5px);
		    width: 0;
		    height: 0;
		    border: 6px solid transparent;
		    border-color: #fff transparent transparent transparent;
		}

		.iu-select-hide {
		    display: none;
		}

		.iu-select-selected.iu-select-arrow-active:after {
		    border-color: transparent transparent #fff transparent;
		    transform: translate(0, calc(-50% - 3px));
		}

		/* style the items (options), including the selected item: */
		.iu-select-items div,.iu-select-selected {
		    color: #ffffff;
		    padding: 5px 10px;
		    border: 1px solid transparent;
		    border-color: transparent transparent rgba(0, 0, 0, 0.1) transparent;
		    cursor: pointer;
		}

		/* Style items (options): */
		.iu-select-items {
		    position: absolute;
		    background-color: #1f1c1c;
		    left: 0;
		    right: 0;
		    z-index: 99;
		    background-clip: content-box;
		    padding: 0 5px;
		}

		.iu-select-items div:hover, .iu-same-as-selected {
		    background-color: rgba(0, 0, 0, 0.5);
		}
		#iu-image-upload-zone {
		    min-height: 150px;
		    border: 2px dashed #a7a6ab;
		    display: flex;
		    align-items: center;
		    justify-content: center;
		    flex-direction: column;
		    cursor: pointer;
		    flex: 1 1 100%;
		    text-align: center;
		    vertical-align: top;
		    margin-top: 16px;
		}
		#iu-image-upload-zone:hover {
		    border: 2px dashed #17a2b8;
		    border: 2px dashed #35ea35;
		}
		.iu-image-note {
		    font-weight: 700;
		}
		#iu-image-upload-zone input[type=file], /* FF, IE7+, chrome (except button) */
		#iu-image-upload-zone input[type=file]::-webkit-file-upload-button { /* chromes and blink button */
		    cursor: pointer;
		}

		/* Spinner for image upload note */
		.iu-spinner {
		  border-top: 5px solid #3498db;
		  border-right: 5px solid #67b2e4;
		  border-bottom: 5px solid #67b2e4;
		  border-left: 5px solid #67b2e4;
		  border-radius: 50%;
		  width: 40px;
		  height: 40px;
		  animation: iu-spin 700ms linear infinite;
		  margin: auto;
		  margin-top: 10px;
		}

		@keyframes  iu-spin {
		  0% { transform: rotate(0deg); }
		  100% { transform: rotate(360deg); }
		}
		.iu-progress-bar {
		    width: 100%;
		    background-color: white;
		    border-radius: 0px;
		    margin: 0;
		    position: absolute;
		    left: 0;
		    padding: 5px;
		    bottom: 0;
		    background-clip: content-box;
		}

		.iu-percent-bar {
		    width: 0%;
		    height: 7px;
		    background-color: #4CAF50;
		    text-align: center;
		    line-height: 0px;
		    color: white;
		    border-radius: 0px;
		    font-size: 1rem;
		}
		.iu-flash-box {
		    position: fixed;
		    z-index: 2000;
		    color: #ffffff;
		    border-radius: 30px;
		    background: rgba(37,34,74,.9);
		    padding: 20px 20px;
		    text-align: center;
		    width: 80%;
		    max-width: 400px;
		    top: 10%;
		    left: 50%;
		    transform: translate(-50%, 0%);
		}
	</style>
	<script>
		var user = '{{request.user}}'
		var user_is_vendor = '{{request.user.is_vendor}}'
		var logoPath = "{% static '/images/h24.png' %}"



		function getToken(name) {
			let cookieValue = null;
			if (document.cookie && document.cookie !== '') {
				const cookies = document.cookie.split(';');
				for (let i = 0; i < cookies.length; i++) {
					const cookie = cookies[i].trim();
					// Does this cookie string begin with the name we want?
					if (cookie.substring(0, name.length + 1) === (name + '=')) {
						console.log("heres 1233")
						cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
						break;
					}
				}
			}
			return cookieValue;
		}
		const csrftoken = getToken('csrftoken');

		function getCookie(name) {
			// Split cookie string and get all individual name=value pairs in an array
			var cookieArr = document.cookie.split(";");
			
			for(var i = 0; i < cookieArr.length; i++) {
				var cookiePair = cookieArr[i].split("=");
			
				/* Removing whitespace at the beginning of the cookie name
				and compare it with the given string */
				if(name == cookiePair[0].trim()) {
					// Decode the cookie value and return
					return decodeURIComponent (cookiePair[1]);
				}
			}
			return null;
		}
		var cart = JSON.parse(getCookie('cart'))
		
		if(cart == undefined) {
			cart = {}
			console.log('Cart was created')
			document.cookie = 'cart=' + JSON.stringify(cart) + ';domain=;path=/'
		}
		

		console.log('Cart:', cart)
	</script>

</head>
	<body>
		<div class="container">
			<div class="row justify-content-center">
			    <div class=" w-100">
			      	<div class="card">
				        <div class="card-header">
					        <div class="d-flex">
					            <div class="align-self-center flex-grow-1">Edit product | #1 <span id="titleMessage"></span>
					            </div>
					        </div>
						 	 <div class="align-self-center py-3  " style="background-color: inherit;">
								<button href="" class="btn btn-danger tab">Cancel</button>
								<button href="" class="btn btn-primary tab" onclick="openCity(event, 'manimages')">Manage media</button>
								<button href="" class="btn btn-primary tab" onclick="openCity(event, 'reviews')">Reviews</button>
							</div>
				        </div>
			        </div>
			        <div class="card-body">
						<div id="manimages" class="tabcontent p-5" style="display: block">
							<form id="addProduct" method="POST" enctype="multipart/form-data">
							{% csrf_token %}
							<!-- main product data -->
								<div class="row">
									<div class="col-md-4 border border-dark" style="display: flex;justify-content: center;background-color: aliceblue;padding: 50px;">
										<div style="text-align: center;margin: auto;">
										 	<div style="text-align: center;margin: auto;">
										    	<div id="img-preview" style="display: block;">
										    		<img id="mainImage" name="choose-file" src="{{ productimage }}" />
										    	</div>
										    	<input type="file" accept="image/*" name="choose-file"  id="choose-file" name="choose-file" />
										    	<label for="choose-file">Choose 2 File</label>
										  	</div>
										</div>
									</div>
									<div class="col-md-8">
										<div class="form-group">
											<label for="title" class="col-form-label">Title</label>
												<input type="text" name="title" class="form-control" id="title">
												<!-- {{ form.title }}											 -->
										</div>
										<div class="form-group">
											<label for="category" class=" col-form-label">Category</label>
											<div class="">
												<div class="input-categories">
												  	<ul name="categories">
													<!-- {% for category in categories %}
      													<li>
															{{ category }}
      														<span onclick="see()" class="icon icon-remove remove-category"></span><input type="hidden" name="categories" value="{{ category }}">
														</li>		
													{% endfor %} -->
												  	</ul>
												  	<input class="form-control" placeholder="Press Enter To Create Category" type="text"/>
												</div>
											</div>
										</div>
										<div class="form-group">
											<label for="brand" class="col-form-label">Brand</label>
											<div class="">
												<input type="text" class="form-control" name="brand" id="brand">
											</div>
										</div>
										<div class="form-group">
											<label for="stock" class="col-form-label">Stock</label>
											<br>
											<div class="stock d-flex">
												
												<input type="number" name="stock" class="form-control" id="stock" min="1" value="1" onkeypress="return isNumberKey(event)" /> 
											</div>
										</div>
										<div class="form-group">
											<label for="description" class="col-form-label">Description</label>
											<div class="">
												<textarea class="form-control textarea" name="description" id="description" ></textarea>
											</div>
										</div>
									</div>
								</div>
								<div class="row">
									<h4 class="py-3">Prices</h4>
									<hr/>
									<div class="col-md-12 ">
										<div class="form-group ">
											<label for="price" class=" col-form-label">Price</label>
											<div class="">
												<input type='price' name="price" class="form-control" value="0.00" placeholder='Type a number & click outside' />
											</div>
										</div>
										<div class="form-group">
											<label for="dicsount" class="col-form-label">Discount Price</label>
											<div class="">
												<input type='discount' name="discount" class="form-control" value="0.00" placeholder='Type a number & click outside' />
											</div>
										</div>
										<!-- <div class="form-group row">
											<label for="attr_3" class="col-sm-2 col-form-label"></label>
											<div class="col-sm-10">
											<input type="text" class="form-control" id="attr_3" value="2кг" />
											</div>
										</div> -->
									</div>
								</div>
									
    							
								<div class="row">
									<h4 class="py-3">Extra Product Images
										<br>
									<small class="small">(Maximum images for upload is 24)</small>
									</h4>
									<hr/>
									<div id="image-upload-demo" class="my-3">
										<div id="iu-gallery"></div>
										<div id="iu-image-upload-zone"></div>
									</div>
								</div>

								<input type="hidden" name="form_type" value="addProduct">
								<input class="btn btn-primary" type="submit" value="Save" name="Update Information" style="box-shadow: none;box-shadow: none;width: 100%;padding: 11px 0 30px 0;" >
							</form>
							<!-- /Attributes -->
						</div>

						<div id="reviews" class="tabcontent">
							<!-- <div class="prate">
								<div class="prate-head">
									<span class="heading py-1 d-block">Product Rating</span>
									<br>
									<div class=" stars my-1 d-flex">
										<span class="fa fa-star icon icon-star checked"></span>
										<span class="fa fa-star icon icon-star checked"></span>
										<span class="fa fa-star icon icon-star checked"></span>
										<span class="fa fa-star icon icon-star checked"></span>
										<span class="fa fa-star icon icon-star_border"></span>
									</div>
									<p class=" py-1">4.1 average based on 254 reviews.</p>
									<hr style="border:3px solid #f1f1f1">
								</div>
								<div class="row">
									<div class="side">
										<div>5 star</div>
									</div>
									<div class="middle">
										<div class="bar-container">
										<div class="bar-5"></div>
										</div>
									</div>
									<div class="side right">
										<div>150</div>
									</div>
									<div class="side">
										<div>4 star</div>
									</div>
									<div class="middle">
										<div class="bar-container">
										<div class="bar-4"></div>
										</div>
									</div>
									<div class="side right">
										<div>63</div>
									</div>
									<div class="side">
										<div>3 star</div>
									</div>
									<div class="middle">
										<div class="bar-container">
										<div class="bar-3"></div>
										</div>
									</div>
									<div class="side right">
										<div>15</div>
									</div>
									<div class="side">
										<div>2 star</div>
									</div>
									<div class="middle">
										<div class="bar-container">
										<div class="bar-2"></div>
										</div>
									</div>
									<div class="side right">
										<div>6</div>
									</div>
									<div class="side">
										<div>1 star</div>
									</div>
									<div class="middle">
										<div class="bar-container">
										<div class="bar-1"></div>
										</div>
									</div>
									<div class="side right">
										<div>20</div>
									</div>
								</div>				
							</div> -->
							{% for review in reviews %}							
								<div class="testimonial-box">
									<!--top------------------------->
									<div class="box-top">
										<!--profile----->
										<div class="profile">
											<!--img---->
											<div class="profile-img">
												<img src="https://cdn3.iconfinder.com/data/icons/avatars-15/64/_Ninja-2-512.png" />
											</div>
											<!--name-and-username-->
											<div class="name-user">
												<strong>{{ reverw.customer }}</strong>
												<span>@{{ review.customer.username }}</span>
											</div>
										</div>
										<!--reviews------>
										<div class="reviews">
											<i class="fas fa-star"></i>
											<i class="fas fa-star"></i>
											<i class="fas fa-star"></i>
											<i class="fas fa-star"></i>
											<i class="far fa-star"></i><!--Empty star-->
										</div>
									</div>
									<!--Comments---------------------------------------->
									<div class="client-comment">
										<h6>{{ review.product }}</h6>
										<p>{{ review.content }}</p>
										<small>{{ review.date_added }}</small>
									</div>
								</div>
							{% endfor %}
						</div>
			        </div>
			     </div>
			    </div>
			</div>
		</div>
		
		{{ form.as_p }}
		{{ form.image.value }}

		<footer class="note">This is cool because you don't need to change the color of the link on :hover. The mix-blend-mode in the ::after will invert it for you.</footer>
		<script src="{% static '/js/pedit.js' %}"></script>
		<script type="text/javascript">
			function removeItemOnce(arr, index) {
				arr.splice(index, 1);
				return arr;
			}
			
			function indexOfCustom (parentArray, searchElement) {
			    for ( var i = 0; i < parentArray.length; i++ ) {
			        if ( parentArray[i][0] == searchElement[0] || parentArray[i][1] == searchElement[1] ) {
			            return i;
			        }
			    }
			    return -1;
			}
			
			var removeCategoryBtns = document.getElementsByClassName('remove-category');

			function see(e) {
			    var e = event || e;
			    var category = String(e.target.parentNode.innerText)
			    const index = indexOfCustom(categories,category);
				removeItemOnce(categories, index)
			    // console.log(typeof categories,typeof category)
			    e.target.parentNode.remove()
			    e.preventDefault();
			}

		</script>
		<script src="{% static '/bootstrap/js/bootstrap.bundle.js' %}"></script>
		<script src="{% static '/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
		<script src="{% static '/bootstrap/js/bootstrap.js' %}"></script>
		<script src="{% static '/bootstrap/js/bootstrap.min.js' %}"></script>
		<script src="{% static '/js/vendor.min.js' %}"></script>
		<!-- <script src="{% static '/js/app.js' %}"></script> -->
		<script src="{% static '/js/cart.js' %}"></script>
	</body>
</html>